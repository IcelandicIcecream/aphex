import"../chunks/DsnmJJEf.js";import{p as fe,u as me,e as t,f as w,b as s,c as we,h as g,d as f,a as I,n as c,m as P,t as K,g as e,s as u,i as ge,v as T,r as m,o as _e,q as $e}from"../chunks/DWBROaph.js";import{s as V}from"../chunks/zhm3sqsy.js";import{i as Y}from"../chunks/CrQaW3DA.js";import{c as b}from"../chunks/D4agE4Ng.js";import{a as he}from"../chunks/BSYjuwBa.js";import{g as U}from"../chunks/CrOXdnIQ.js";import{p as j}from"../chunks/DL8tdTp6.js";import{C as xe,a as Pe,d as be,I as W,B as X,e as ye}from"../chunks/CQxSK_kJ.js";import{C as Ce,L as Z}from"../chunks/CC2su3ap.js";import{r as ee}from"../chunks/BegLjn8u.js";var ke=w("<!> <!>",1),qe=w('<div class="rounded-lg border border-green-500/50 bg-green-500/10 p-4 text-center"><p class="font-medium text-green-700 dark:text-green-400">Your password has been reset successfully!</p></div>'),Be=w('<div class="border-destructive/50 bg-destructive/10 rounded-lg border p-3"><p class="text-destructive text-sm font-medium"> </p></div>'),Ie=_e('<svg class="mr-2 h-4 w-4 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Ae=w("<!> Reset Password",1),Le=w('<form class="space-y-4"><!> <div class="space-y-2"><!> <!> <p class="text-muted-foreground text-xs">Must be at least 8 characters long</p></div> <div class="space-y-2"><!> <!></div> <!> <!></form>'),Ne=w("<!> <!>",1),Re=w('<div class="bg-muted/40 flex min-h-screen items-center justify-center px-4 py-12"><div class="w-full max-w-md"><!> <p class="text-muted-foreground mt-6 text-center text-xs">Aphex CMS - Built with SvelteKit</p></div></div>');function Oe(re,te){fe(te,!0);let _=g(""),A=g(""),d=g(""),y=g(!1),i=g(!1),$=g("");me(()=>{j.url.searchParams.get("error")==="INVALID_TOKEN"?t(d,"Invalid or expired reset link. Please request a new password reset."):j.params.token?t($,j.params.token,!0):t(d,"No reset token provided. Please request a new password reset.")});async function se(C){if(C.preventDefault(),t(d,""),t(i,!0),e(_)!==e(A)){t(d,"Passwords do not match"),t(i,!1);return}if(e(_).length<8){t(d,"Password must be at least 8 characters long"),t(i,!1);return}try{const v=await he.resetPassword({newPassword:e(_),token:e($)});v.error?t(d,v.error.message||"Failed to reset password",!0):(t(y,!0),setTimeout(()=>{U(ee("/login"))},2e3))}catch(v){t(d,v instanceof Error?v.message:"An error occurred",!0)}finally{t(i,!1)}}var L=Re(),F=f(L),ae=f(F);b(ae,()=>ye,(C,v)=>{v(C,{class:"shadow-lg",children:(oe,Ee)=>{var H=Ne(),O=I(H);b(O,()=>xe,(N,R)=>{R(N,{class:"space-y-1",children:(E,de)=>{var h=ke(),k=I(h);b(k,()=>Pe,(x,o)=>{o(x,{class:"text-center text-2xl font-bold",children:(l,q)=>{c();var p=P();K(()=>V(p,e(y)?"Password Reset!":"Reset Your Password")),s(l,p)},$$slots:{default:!0}})});var M=u(k,2);b(M,()=>Ce,(x,o)=>{o(x,{class:"text-center",children:(l,q)=>{c();var p=P();K(()=>V(p,e(y)?"Redirecting to login...":"Enter your new password")),s(l,p)},$$slots:{default:!0}})}),s(E,h)},$$slots:{default:!0}})});var le=u(O,2);b(le,()=>be,(N,R)=>{R(N,{children:(E,de)=>{var h=ge(),k=I(h);{var M=o=>{var l=qe();s(o,l)},x=o=>{var l=Le(),q=f(l);{var p=r=>{var a=Be(),n=f(a),B=f(n,!0);m(n),m(a),K(()=>V(B,e(d))),s(r,a)};Y(q,r=>{e(d)&&r(p)})}var S=u(q,2),G=f(S);Z(G,{for:"newPassword",children:(r,a)=>{c();var n=P("New Password");s(r,n)},$$slots:{default:!0}});var ne=u(G,2);{let r=T(()=>!e($)||e(i));W(ne,{id:"newPassword",type:"password",placeholder:"••••••••",required:!0,autocomplete:"new-password",get disabled(){return e(r)},get value(){return e(_)},set value(a){t(_,a,!0)}})}c(2),m(S);var z=u(S,2),J=f(z);Z(J,{for:"confirmPassword",children:(r,a)=>{c();var n=P("Confirm Password");s(r,n)},$$slots:{default:!0}});var ie=u(J,2);{let r=T(()=>!e($)||e(i));W(ie,{id:"confirmPassword",type:"password",placeholder:"••••••••",required:!0,autocomplete:"new-password",get disabled(){return e(r)},get value(){return e(A)},set value(a){t(A,a,!0)}})}m(z);var Q=u(z,2);{let r=T(()=>!e($)||e(i));X(Q,{type:"submit",class:"w-full",get disabled(){return e(r)},children:(a,n)=>{var B=Ae(),ue=I(B);{var ve=D=>{var pe=Ie();s(D,pe)};Y(ue,D=>{e(i)&&D(ve)})}c(),s(a,B)},$$slots:{default:!0}})}var ce=u(Q,2);X(ce,{type:"button",variant:"ghost",class:"w-full",onclick:()=>U(ee("/login")),children:(r,a)=>{c();var n=P("← Back to Login");s(r,n)},$$slots:{default:!0}}),m(l),$e("submit",l,se),s(o,l)};Y(k,o=>{e(y)?o(M):o(x,!1)})}s(E,h)},$$slots:{default:!0}})}),s(oe,H)},$$slots:{default:!0}})}),c(2),m(F),m(L),s(re,L),we()}export{Oe as component};
